{"version":3,"file":"inject-partytown-snippet.js","names":["injectPartytownSnippet","collectedScripts","length","existingSnippet","document","querySelector","existingSandbox","remove","forwards","getForwards","snippet","createElement","dataset","partytown","innerHTML","partytownSnippet","forward","head","appendChild"],"sources":["../../../../src/internal-plugins/partytown/utils/inject-partytown-snippet.ts"],"sourcesContent":["import { partytownSnippet } from \"@builder.io/partytown/integration\"\nimport { ScriptProps } from \"gatsby-script\"\nimport { getForwards } from \"./get-forwards\"\n\n// Adapted from https://github.com/BuilderIO/partytown/blob/main/src/react/snippet.tsx to only include CSR logic\nexport function injectPartytownSnippet(\n  collectedScripts: Array<ScriptProps>\n): void {\n  if (!collectedScripts.length) {\n    return\n  }\n\n  const existingSnippet = document.querySelector(`script[data-partytown]`)\n  const existingSandbox = document.querySelector(\n    `iframe[src*=\"~partytown/partytown-sandbox-sw\"]`\n  )\n\n  if (existingSnippet) {\n    existingSnippet.remove()\n  }\n\n  if (existingSandbox) {\n    existingSandbox.remove()\n  }\n\n  const forwards = getForwards(collectedScripts)\n\n  const snippet = document.createElement(`script`)\n  snippet.dataset.partytown = ``\n  snippet.innerHTML = partytownSnippet({ forward: forwards })\n  document.head.appendChild(snippet)\n}\n"],"mappings":";;;;AAAA;AAEA;AAEA;AACO,SAASA,sBAAsB,CACpCC,gBAAoC,EAC9B;EACN,IAAI,CAACA,gBAAgB,CAACC,MAAM,EAAE;IAC5B;EACF;EAEA,MAAMC,eAAe,GAAGC,QAAQ,CAACC,aAAa,CAAE,wBAAuB,CAAC;EACxE,MAAMC,eAAe,GAAGF,QAAQ,CAACC,aAAa,CAC3C,gDAA+C,CACjD;EAED,IAAIF,eAAe,EAAE;IACnBA,eAAe,CAACI,MAAM,EAAE;EAC1B;EAEA,IAAID,eAAe,EAAE;IACnBA,eAAe,CAACC,MAAM,EAAE;EAC1B;EAEA,MAAMC,QAAQ,GAAG,IAAAC,wBAAW,EAACR,gBAAgB,CAAC;EAE9C,MAAMS,OAAO,GAAGN,QAAQ,CAACO,aAAa,CAAE,QAAO,CAAC;EAChDD,OAAO,CAACE,OAAO,CAACC,SAAS,GAAI,EAAC;EAC9BH,OAAO,CAACI,SAAS,GAAG,IAAAC,6BAAgB,EAAC;IAAEC,OAAO,EAAER;EAAS,CAAC,CAAC;EAC3DJ,QAAQ,CAACa,IAAI,CAACC,WAAW,CAACR,OAAO,CAAC;AACpC"}