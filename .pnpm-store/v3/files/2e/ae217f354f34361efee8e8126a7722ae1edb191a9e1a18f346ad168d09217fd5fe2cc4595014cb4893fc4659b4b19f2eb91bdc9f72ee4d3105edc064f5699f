{"version":3,"file":"clean.js","names":["module","exports","clean","program","directory","report","directories","findCacheDir","name","filter","Boolean","info","join","Promise","all","map","dir","fs","remove","path","userGetsSevenDayFeedback","showSevenDayFeedbackRequest","userPassesFeedbackRequestHeuristic","showFeedbackRequest"],"sources":["../../src/commands/clean.ts"],"sourcesContent":["import fs from \"fs-extra\"\nimport path from \"path\"\nimport findCacheDir from \"find-cache-dir\"\n\nimport {\n  userGetsSevenDayFeedback,\n  userPassesFeedbackRequestHeuristic,\n  showFeedbackRequest,\n  showSevenDayFeedbackRequest,\n} from \"../utils/feedback\"\nimport { IProgram } from \"./types\"\n\nmodule.exports = async function clean(program: IProgram): Promise<void> {\n  const { directory, report } = program\n\n  const directories = [\n    `.cache`,\n    `public`,\n    // Ensure we clean babel loader cache\n    findCacheDir({\n      name: `babel-loader`,\n    }),\n    findCacheDir({\n      name: `terser-webpack-plugin`,\n    }),\n  ].filter(Boolean)\n\n  report.info(`Deleting ${directories.join(`, `)}`)\n\n  await Promise.all(\n    directories.map(dir => fs.remove(path.join(directory, dir)))\n  )\n\n  report.info(`Successfully deleted directories`)\n\n  if (await userGetsSevenDayFeedback()) {\n    showSevenDayFeedbackRequest()\n  } else if (await userPassesFeedbackRequestHeuristic()) {\n    showFeedbackRequest()\n  }\n}\n"],"mappings":";;;AAAA;AACA;AACA;AAEA;AAQAA,MAAM,CAACC,OAAO,GAAG,eAAeC,KAAK,CAACC,OAAiB,EAAiB;EACtE,MAAM;IAAEC,SAAS;IAAEC;EAAO,CAAC,GAAGF,OAAO;EAErC,MAAMG,WAAW,GAAG,CACjB,QAAO,EACP,QAAO;EACR;EACA,IAAAC,qBAAY,EAAC;IACXC,IAAI,EAAG;EACT,CAAC,CAAC,EACF,IAAAD,qBAAY,EAAC;IACXC,IAAI,EAAG;EACT,CAAC,CAAC,CACH,CAACC,MAAM,CAACC,OAAO,CAAC;EAEjBL,MAAM,CAACM,IAAI,CAAE,YAAWL,WAAW,CAACM,IAAI,CAAE,IAAG,CAAE,EAAC,CAAC;EAEjD,MAAMC,OAAO,CAACC,GAAG,CACfR,WAAW,CAACS,GAAG,CAACC,GAAG,IAAIC,gBAAE,CAACC,MAAM,CAACC,aAAI,CAACP,IAAI,CAACR,SAAS,EAAEY,GAAG,CAAC,CAAC,CAAC,CAC7D;EAEDX,MAAM,CAACM,IAAI,CAAE,kCAAiC,CAAC;EAE/C,IAAI,MAAM,IAAAS,kCAAwB,GAAE,EAAE;IACpC,IAAAC,qCAA2B,GAAE;EAC/B,CAAC,MAAM,IAAI,MAAM,IAAAC,4CAAkC,GAAE,EAAE;IACrD,IAAAC,6BAAmB,GAAE;EACvB;AACF,CAAC"}