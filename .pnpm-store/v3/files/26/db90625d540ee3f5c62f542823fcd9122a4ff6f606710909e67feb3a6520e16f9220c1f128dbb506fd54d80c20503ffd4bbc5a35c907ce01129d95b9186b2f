{"version":3,"file":"babelrc.js","names":["babelrcReducer","state","stages","develop","plugins","presets","options","cacheDirectory","sourceType","action","type","Object","keys","forEach","stage","payload","index","plugin","name"],"sources":["../../../src/redux/reducers/babelrc.ts"],"sourcesContent":["import _ from \"lodash\"\n\nimport { IGatsbyState, ActionsUnion, IPlugin } from \"../types\"\n\nexport const babelrcReducer = (\n  state: IGatsbyState[\"babelrc\"] = {\n    stages: {\n      develop: {\n        plugins: [],\n        presets: [],\n        options: {\n          cacheDirectory: true,\n          sourceType: `unambiguous`,\n        },\n      },\n      \"develop-html\": {\n        plugins: [],\n        presets: [],\n        options: {\n          cacheDirectory: true,\n          sourceType: `unambiguous`,\n        },\n      },\n      \"build-html\": {\n        plugins: [],\n        presets: [],\n        options: {\n          cacheDirectory: true,\n          sourceType: `unambiguous`,\n        },\n      },\n      \"build-javascript\": {\n        plugins: [],\n        presets: [],\n        options: {\n          cacheDirectory: true,\n          sourceType: `unambiguous`,\n        },\n      },\n    },\n  },\n  action: ActionsUnion\n): IGatsbyState[\"babelrc\"] => {\n  switch (action.type) {\n    case `SET_BABEL_PLUGIN`: {\n      Object.keys(state.stages).forEach(stage => {\n        if (action.payload.stage && action.payload.stage !== stage) {\n          return\n        }\n\n        const index = _.findIndex(\n          state.stages[stage].plugins,\n          (plugin: IPlugin) => plugin.name === action.payload.name\n        )\n        // If the plugin already exists, merge the options.\n        // Otherwise, add it to the end.\n        if (index !== -1) {\n          const plugin = state.stages[stage].plugins[index]\n          state.stages[stage].plugins[index] = {\n            name: plugin.name,\n            options: _.merge(plugin.options, action.payload.options),\n          }\n        } else {\n          state.stages[stage].plugins = [\n            ...state.stages[stage].plugins,\n            action.payload,\n          ]\n        }\n      })\n\n      return state\n    }\n    case `SET_BABEL_PRESET`: {\n      Object.keys(state.stages).forEach(stage => {\n        if (action.payload.stage && action.payload.stage !== stage) {\n          return\n        }\n\n        const index = _.findIndex(\n          state.stages[stage].presets,\n          (plugin: IPlugin) => plugin.name === action.payload.name\n        )\n        // If the plugin already exists, merge the options.\n        // Otherwise, add it to the end.\n        if (index !== -1) {\n          const plugin = state.stages[stage].presets[index]\n          state.stages[stage].presets[index] = {\n            name: plugin.name,\n            options: _.merge(plugin.options, action.payload.options),\n          }\n        } else {\n          state.stages[stage].presets = [\n            ...state.stages[stage].presets,\n            action.payload,\n          ]\n        }\n      })\n      return state\n    }\n    case `SET_BABEL_OPTIONS`: {\n      Object.keys(state.stages).forEach(stage => {\n        if (action.payload.stage && action.payload.stage !== stage) {\n          return\n        }\n\n        state.stages[stage].options = {\n          ...state.stages[stage].options,\n          ...action.payload.options,\n        }\n      })\n      return state\n    }\n  }\n\n  return state\n}\n"],"mappings":"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"}