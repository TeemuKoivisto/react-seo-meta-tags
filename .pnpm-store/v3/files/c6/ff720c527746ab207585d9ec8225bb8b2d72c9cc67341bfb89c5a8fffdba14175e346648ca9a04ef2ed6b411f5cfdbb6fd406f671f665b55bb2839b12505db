{"version":3,"file":"reporter.js","names":["initReporterMessagingInMainProcess","workerPool","reporter","_initReporterMessagingInMain","onMessage","bind","gatsbyWorkerMessenger","getMessenger","initReporterMessagingInWorker","isWorker","_initReporterMessagingInWorker","sendMessage","process","on","reason","panic","err"],"sources":["../../../src/utils/worker/reporter.ts"],"sourcesContent":["import reporter from \"gatsby-cli/lib/reporter\"\nimport { GatsbyWorkerPool } from \"./types\"\nimport { isWorker, getMessenger } from \"./messaging\"\n\nexport function initReporterMessagingInMainProcess(\n  workerPool: GatsbyWorkerPool\n): void {\n  if (typeof reporter._initReporterMessagingInMain === `function`) {\n    reporter._initReporterMessagingInMain(workerPool.onMessage.bind(workerPool))\n  }\n}\n\nconst gatsbyWorkerMessenger = getMessenger()\nexport function initReporterMessagingInWorker(): void {\n  if (\n    isWorker &&\n    gatsbyWorkerMessenger &&\n    typeof reporter._initReporterMessagingInWorker === `function`\n  ) {\n    reporter._initReporterMessagingInWorker(\n      gatsbyWorkerMessenger.sendMessage.bind(gatsbyWorkerMessenger)\n    )\n\n    process.on(`unhandledRejection`, (reason: unknown) => {\n      reporter.panic((reason as Error) || `Unhandled rejection`)\n    })\n\n    process.on(`uncaughtException`, function (err) {\n      reporter.panic(err)\n    })\n  }\n}\n"],"mappings":";;;;;;AAAA;AAEA;AAEO,SAASA,kCAAkC,CAChDC,UAA4B,EACtB;EACN,IAAI,OAAOC,iBAAQ,CAACC,4BAA4B,KAAM,UAAS,EAAE;IAC/DD,iBAAQ,CAACC,4BAA4B,CAACF,UAAU,CAACG,SAAS,CAACC,IAAI,CAACJ,UAAU,CAAC,CAAC;EAC9E;AACF;AAEA,MAAMK,qBAAqB,GAAG,IAAAC,uBAAY,GAAE;AACrC,SAASC,6BAA6B,GAAS;EACpD,IACEC,mBAAQ,IACRH,qBAAqB,IACrB,OAAOJ,iBAAQ,CAACQ,8BAA8B,KAAM,UAAS,EAC7D;IACAR,iBAAQ,CAACQ,8BAA8B,CACrCJ,qBAAqB,CAACK,WAAW,CAACN,IAAI,CAACC,qBAAqB,CAAC,CAC9D;IAEDM,OAAO,CAACC,EAAE,CAAE,oBAAmB,EAAGC,MAAe,IAAK;MACpDZ,iBAAQ,CAACa,KAAK,CAAED,MAAM,IAAe,qBAAoB,CAAC;IAC5D,CAAC,CAAC;IAEFF,OAAO,CAACC,EAAE,CAAE,mBAAkB,EAAE,UAAUG,GAAG,EAAE;MAC7Cd,iBAAQ,CAACa,KAAK,CAACC,GAAG,CAAC;IACrB,CAAC,CAAC;EACJ;AACF"}