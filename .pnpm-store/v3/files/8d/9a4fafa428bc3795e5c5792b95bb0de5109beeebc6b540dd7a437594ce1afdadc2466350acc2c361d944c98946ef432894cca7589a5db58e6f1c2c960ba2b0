{"version":3,"file":"webpack-remove-exports-loader.js","names":["webpackRemoveExportsLoader","source","sourceMap","callback","async","options","getOptions","transform","babelrc","configFile","inputSourceMap","undefined","sourceFileName","resourcePath","sourceMaps","filename","presets","jsx","require","resolve","useBuiltIns","pragma","development","plugins","apis","remove","err","result","code","map","module","exports"],"sources":["../../../../src/utils/webpack/loaders/webpack-remove-exports-loader.ts"],"sourcesContent":["/* eslint-disable @babel/no-invalid-this */\n\nimport { LoaderDefinitionFunction } from \"webpack\"\nimport { transform } from \"@babel/core\"\n\ninterface IOptions {\n  jsx?: boolean\n  remove?: Array<string>\n}\n\nconst webpackRemoveExportsLoader: LoaderDefinitionFunction<IOptions> =\n  function webpackRemoveExportsLoader(source, sourceMap): void {\n    const callback = this.async()\n    const options = this.getOptions()\n\n    transform(\n      source,\n      {\n        babelrc: false,\n        configFile: false,\n        // @ts-ignore inputSourceMap expect object or falsy, but webpack types suggest sourceMap can be a string,\n        // which is not compatibile with babel's transform options\n        inputSourceMap: this.sourceMap ? sourceMap || undefined : undefined,\n        sourceFileName: this.resourcePath,\n        sourceMaps: this.sourceMap,\n        filename: this.resourcePath,\n        presets: options?.jsx\n          ? [\n              [\n                require.resolve(`babel-preset-gatsby/babel-preset-react`),\n                {\n                  useBuiltIns: true,\n                  pragma: `React.createElement`,\n                  // jsx is used only in develop, so for now this is fine\n                  development: true,\n                },\n              ],\n            ]\n          : undefined,\n        plugins: [\n          [\n            require.resolve(`../../babel/babel-plugin-remove-api`),\n            {\n              apis: options?.remove ?? [],\n            },\n          ],\n        ],\n      },\n      (err, result) => {\n        if (err) {\n          callback(err)\n        } else if (result && result.code) {\n          callback(null, result?.code, result?.map ?? undefined)\n        } else {\n          callback(null, source, sourceMap)\n        }\n      }\n    )\n  }\n\nmodule.exports = webpackRemoveExportsLoader\n"],"mappings":";;AAGA;AAHA;;AAUA,MAAMA,0BAA8D,GAClE,SAASA,0BAA0B,CAACC,MAAM,EAAEC,SAAS,EAAQ;EAAA;EAC3D,MAAMC,QAAQ,GAAG,IAAI,CAACC,KAAK,EAAE;EAC7B,MAAMC,OAAO,GAAG,IAAI,CAACC,UAAU,EAAE;EAEjC,IAAAC,eAAS,EACPN,MAAM,EACN;IACEO,OAAO,EAAE,KAAK;IACdC,UAAU,EAAE,KAAK;IACjB;IACA;IACAC,cAAc,EAAE,IAAI,CAACR,SAAS,GAAGA,SAAS,IAAIS,SAAS,GAAGA,SAAS;IACnEC,cAAc,EAAE,IAAI,CAACC,YAAY;IACjCC,UAAU,EAAE,IAAI,CAACZ,SAAS;IAC1Ba,QAAQ,EAAE,IAAI,CAACF,YAAY;IAC3BG,OAAO,EAAEX,OAAO,aAAPA,OAAO,eAAPA,OAAO,CAAEY,GAAG,GACjB,CACE,CACEC,OAAO,CAACC,OAAO,CAAE,wCAAuC,CAAC,EACzD;MACEC,WAAW,EAAE,IAAI;MACjBC,MAAM,EAAG,qBAAoB;MAC7B;MACAC,WAAW,EAAE;IACf,CAAC,CACF,CACF,GACDX,SAAS;IACbY,OAAO,EAAE,CACP,CACEL,OAAO,CAACC,OAAO,CAAE,qCAAoC,CAAC,EACtD;MACEK,IAAI,qBAAEnB,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEoB,MAAM,6DAAI;IAC3B,CAAC,CACF;EAEL,CAAC,EACD,CAACC,GAAG,EAAEC,MAAM,KAAK;IACf,IAAID,GAAG,EAAE;MACPvB,QAAQ,CAACuB,GAAG,CAAC;IACf,CAAC,MAAM,IAAIC,MAAM,IAAIA,MAAM,CAACC,IAAI,EAAE;MAAA;MAChCzB,QAAQ,CAAC,IAAI,EAAEwB,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAEC,IAAI,iBAAED,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAEE,GAAG,qDAAIlB,SAAS,CAAC;IACxD,CAAC,MAAM;MACLR,QAAQ,CAAC,IAAI,EAAEF,MAAM,EAAEC,SAAS,CAAC;IACnC;EACF,CAAC,CACF;AACH,CAAC;AAEH4B,MAAM,CAACC,OAAO,GAAG/B,0BAA0B"}