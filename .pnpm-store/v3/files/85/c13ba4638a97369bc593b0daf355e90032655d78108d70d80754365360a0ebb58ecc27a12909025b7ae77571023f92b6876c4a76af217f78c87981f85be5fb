{"version":3,"file":"bundle.js","names":["build","webpackConfig","compiler","webpack","Promise","resolve","reject","run","err","stats","close","hasErrors","compilation","errors","watch","onWatch","watchOptions","watcher"],"sources":["../../../src/utils/webpack/bundle.ts"],"sourcesContent":["import webpack from \"webpack\"\n\nexport function build(webpackConfig: webpack.Configuration): Promise<{\n  stats: webpack.Stats\n  close: () => Promise<void>\n}> {\n  const compiler = webpack(webpackConfig)\n\n  return new Promise((resolve, reject) => {\n    compiler.run((err, stats) => {\n      // stats can only be empty when an error occurs. Adding it to the if makes typescript happy.\n      if (err || !stats) {\n        return compiler.close(() => {\n          reject(err)\n        })\n      }\n\n      if (stats.hasErrors()) {\n        return compiler.close(() => {\n          reject(stats.compilation.errors)\n        })\n      }\n\n      return resolve({\n        stats,\n        close: (): Promise<void> =>\n          new Promise((resolve, reject) =>\n            compiler.close(err => (err ? reject(err) : resolve()))\n          ),\n      })\n    })\n  })\n}\n\nexport function watch(\n  webpackConfig: webpack.Configuration,\n  onWatch: (\n    err: Error | webpack.WebpackError | undefined | null,\n    stats: webpack.Stats | undefined\n  ) => void,\n  watchOptions: webpack.Watching[\"watchOptions\"] = {}\n): {\n  watcher: webpack.Watching\n  close: () => Promise<void>\n} {\n  const compiler = webpack(webpackConfig)\n\n  const watcher = compiler.watch(watchOptions, (err, stats) => {\n    // this runs multiple times\n    onWatch(err, stats)\n  })\n\n  return {\n    watcher,\n    close: (): Promise<void> =>\n      new Promise((resolve, reject) =>\n        watcher.close(err => (err ? reject(err) : resolve()))\n      ),\n  }\n}\n"],"mappings":";;;;;;AAAA;AAEO,SAASA,KAAK,CAACC,aAAoC,EAGvD;EACD,MAAMC,QAAQ,GAAG,IAAAC,gBAAO,EAACF,aAAa,CAAC;EAEvC,OAAO,IAAIG,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCJ,QAAQ,CAACK,GAAG,CAAC,CAACC,GAAG,EAAEC,KAAK,KAAK;MAC3B;MACA,IAAID,GAAG,IAAI,CAACC,KAAK,EAAE;QACjB,OAAOP,QAAQ,CAACQ,KAAK,CAAC,MAAM;UAC1BJ,MAAM,CAACE,GAAG,CAAC;QACb,CAAC,CAAC;MACJ;MAEA,IAAIC,KAAK,CAACE,SAAS,EAAE,EAAE;QACrB,OAAOT,QAAQ,CAACQ,KAAK,CAAC,MAAM;UAC1BJ,MAAM,CAACG,KAAK,CAACG,WAAW,CAACC,MAAM,CAAC;QAClC,CAAC,CAAC;MACJ;MAEA,OAAOR,OAAO,CAAC;QACbI,KAAK;QACLC,KAAK,EAAE,MACL,IAAIN,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAC1BJ,QAAQ,CAACQ,KAAK,CAACF,GAAG,IAAKA,GAAG,GAAGF,MAAM,CAACE,GAAG,CAAC,GAAGH,OAAO,EAAG,CAAC;MAE5D,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ;AAEO,SAASS,KAAK,CACnBb,aAAoC,EACpCc,OAGS,EACTC,YAA8C,GAAG,CAAC,CAAC,EAInD;EACA,MAAMd,QAAQ,GAAG,IAAAC,gBAAO,EAACF,aAAa,CAAC;EAEvC,MAAMgB,OAAO,GAAGf,QAAQ,CAACY,KAAK,CAACE,YAAY,EAAE,CAACR,GAAG,EAAEC,KAAK,KAAK;IAC3D;IACAM,OAAO,CAACP,GAAG,EAAEC,KAAK,CAAC;EACrB,CAAC,CAAC;EAEF,OAAO;IACLQ,OAAO;IACPP,KAAK,EAAE,MACL,IAAIN,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAC1BW,OAAO,CAACP,KAAK,CAACF,GAAG,IAAKA,GAAG,GAAGF,MAAM,CAACE,GAAG,CAAC,GAAGH,OAAO,EAAG,CAAC;EAE3D,CAAC;AACH"}