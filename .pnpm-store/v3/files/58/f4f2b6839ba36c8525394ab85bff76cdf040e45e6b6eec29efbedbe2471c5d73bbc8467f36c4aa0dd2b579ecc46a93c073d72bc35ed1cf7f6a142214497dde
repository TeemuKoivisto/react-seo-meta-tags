{"version":3,"file":"actions.js","names":["flushPageData","context","enqueueFlush","parentSpan","assignDirtyQueries","assign","_context","data","queryIds","markSourceFilesDirty","filesDirty","markSourceFilesClean","trackRequestedQueryRun","pendingQueryRuns","payload","Set","pagePath","add","clearCurrentlyHandledPendingQueryRuns","currentlyHandledPendingQueryRuns","undefined","queryActions"],"sources":["../../../src/state-machines/query-running/actions.ts"],"sourcesContent":["import { IQueryRunningContext } from \"./types\"\nimport {\n  DoneInvokeEvent,\n  assign,\n  ActionFunctionMap,\n  AnyEventObject,\n} from \"xstate\"\nimport { enqueueFlush } from \"../../utils/page-data\"\n\nexport const flushPageData = (context: IQueryRunningContext): void => {\n  enqueueFlush(context.parentSpan)\n}\n\nexport const assignDirtyQueries = assign<\n  IQueryRunningContext,\n  DoneInvokeEvent<any>\n>((_context, { data }) => {\n  const { queryIds } = data\n  return {\n    queryIds,\n  }\n})\n\nexport const markSourceFilesDirty = assign<IQueryRunningContext>({\n  filesDirty: true,\n})\n\nexport const markSourceFilesClean = assign<IQueryRunningContext>({\n  filesDirty: false,\n})\n\nexport const trackRequestedQueryRun = assign<\n  IQueryRunningContext,\n  AnyEventObject\n>({\n  pendingQueryRuns: (context, { payload }) => {\n    const pendingQueryRuns = context.pendingQueryRuns || new Set<string>()\n    if (payload?.pagePath) {\n      pendingQueryRuns.add(payload.pagePath)\n    }\n    return pendingQueryRuns\n  },\n})\n\nexport const clearCurrentlyHandledPendingQueryRuns =\n  assign<IQueryRunningContext>({\n    currentlyHandledPendingQueryRuns: undefined,\n  })\n\nexport const queryActions: ActionFunctionMap<IQueryRunningContext, any> = {\n  assignDirtyQueries,\n  flushPageData,\n  markSourceFilesDirty,\n  markSourceFilesClean,\n  trackRequestedQueryRun,\n  clearCurrentlyHandledPendingQueryRuns,\n}\n"],"mappings":";;;;AACA;AAMA;AAEO,MAAMA,aAAa,GAAIC,OAA6B,IAAW;EACpE,IAAAC,sBAAY,EAACD,OAAO,CAACE,UAAU,CAAC;AAClC,CAAC;AAAA;AAEM,MAAMC,kBAAkB,GAAG,IAAAC,cAAM,EAGtC,CAACC,QAAQ,EAAE;EAAEC;AAAK,CAAC,KAAK;EACxB,MAAM;IAAEC;EAAS,CAAC,GAAGD,IAAI;EACzB,OAAO;IACLC;EACF,CAAC;AACH,CAAC,CAAC;AAAA;AAEK,MAAMC,oBAAoB,GAAG,IAAAJ,cAAM,EAAuB;EAC/DK,UAAU,EAAE;AACd,CAAC,CAAC;AAAA;AAEK,MAAMC,oBAAoB,GAAG,IAAAN,cAAM,EAAuB;EAC/DK,UAAU,EAAE;AACd,CAAC,CAAC;AAAA;AAEK,MAAME,sBAAsB,GAAG,IAAAP,cAAM,EAG1C;EACAQ,gBAAgB,EAAE,CAACZ,OAAO,EAAE;IAAEa;EAAQ,CAAC,KAAK;IAC1C,MAAMD,gBAAgB,GAAGZ,OAAO,CAACY,gBAAgB,IAAI,IAAIE,GAAG,EAAU;IACtE,IAAID,OAAO,aAAPA,OAAO,eAAPA,OAAO,CAAEE,QAAQ,EAAE;MACrBH,gBAAgB,CAACI,GAAG,CAACH,OAAO,CAACE,QAAQ,CAAC;IACxC;IACA,OAAOH,gBAAgB;EACzB;AACF,CAAC,CAAC;AAAA;AAEK,MAAMK,qCAAqC,GAChD,IAAAb,cAAM,EAAuB;EAC3Bc,gCAAgC,EAAEC;AACpC,CAAC,CAAC;AAAA;AAEG,MAAMC,YAA0D,GAAG;EACxEjB,kBAAkB;EAClBJ,aAAa;EACbS,oBAAoB;EACpBE,oBAAoB;EACpBC,sBAAsB;EACtBM;AACF,CAAC;AAAA"}