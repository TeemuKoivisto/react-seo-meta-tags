{"version":3,"file":"gatsby-node.js","names":["emitter","store","require","actions","originalStatusPageByStatus","originalStatusPageByPath","on","action","result","exec","payload","path","length","status","originalPage","storedPage","component","context","dispatch","createPage","plugin","deletePage"],"sources":["../../../src/internal-plugins/prod-404-500/gatsby-node.js"],"sourcesContent":["const { emitter, store } = require(`../../redux`)\nconst { actions } = require(`../../redux/actions`)\n\nconst originalStatusPageByStatus = {}\nconst originalStatusPageByPath = {}\n\nemitter.on(`CREATE_PAGE`, action => {\n  // Copy /404/ to /404.html and /500/ to /500.html. Many static site hosts expect\n  // site 404 pages to be named this. In addition, with Rendering Engines there might\n  // be runtime errors which would fallback to \"/500.html\" page.\n  // https://www.gatsbyjs.com/docs/how-to/adding-common-features/add-404-page/\n  const result = /^\\/?(404|500)\\/?$/.exec(action.payload.path)\n  if (result && result.length > 1) {\n    const status = result[1]\n\n    const originalPage = originalStatusPageByStatus[status]\n\n    if (!originalPage) {\n      const storedPage = {\n        path: action.payload.path,\n        component: action.payload.component,\n        context: action.payload.context,\n        status,\n      }\n\n      originalStatusPageByStatus[status] = storedPage\n      originalStatusPageByPath[action.payload.path] = storedPage\n\n      store.dispatch(\n        actions.createPage(\n          {\n            ...storedPage,\n            path: `/${status}.html`,\n          },\n          action.plugin,\n          action\n        )\n      )\n    }\n  }\n})\n\nemitter.on(`DELETE_PAGE`, action => {\n  const storedPage = originalStatusPageByPath[action.payload.path]\n  if (storedPage) {\n    store.dispatch(\n      actions.deletePage({\n        ...storedPage,\n        path: `/${storedPage.status}.html`,\n      })\n    )\n    originalStatusPageByPath[action.payload.path] = null\n    originalStatusPageByStatus[storedPage.status] = null\n  }\n})\n"],"mappings":";;AAAA,MAAM;EAAEA,OAAO;EAAEC;AAAM,CAAC,GAAGC,OAAO,CAAE,aAAY,CAAC;AACjD,MAAM;EAAEC;AAAQ,CAAC,GAAGD,OAAO,CAAE,qBAAoB,CAAC;AAElD,MAAME,0BAA0B,GAAG,CAAC,CAAC;AACrC,MAAMC,wBAAwB,GAAG,CAAC,CAAC;AAEnCL,OAAO,CAACM,EAAE,CAAE,aAAY,EAAEC,MAAM,IAAI;EAClC;EACA;EACA;EACA;EACA,MAAMC,MAAM,GAAG,mBAAmB,CAACC,IAAI,CAACF,MAAM,CAACG,OAAO,CAACC,IAAI,CAAC;EAC5D,IAAIH,MAAM,IAAIA,MAAM,CAACI,MAAM,GAAG,CAAC,EAAE;IAC/B,MAAMC,MAAM,GAAGL,MAAM,CAAC,CAAC,CAAC;IAExB,MAAMM,YAAY,GAAGV,0BAA0B,CAACS,MAAM,CAAC;IAEvD,IAAI,CAACC,YAAY,EAAE;MACjB,MAAMC,UAAU,GAAG;QACjBJ,IAAI,EAAEJ,MAAM,CAACG,OAAO,CAACC,IAAI;QACzBK,SAAS,EAAET,MAAM,CAACG,OAAO,CAACM,SAAS;QACnCC,OAAO,EAAEV,MAAM,CAACG,OAAO,CAACO,OAAO;QAC/BJ;MACF,CAAC;MAEDT,0BAA0B,CAACS,MAAM,CAAC,GAAGE,UAAU;MAC/CV,wBAAwB,CAACE,MAAM,CAACG,OAAO,CAACC,IAAI,CAAC,GAAGI,UAAU;MAE1Dd,KAAK,CAACiB,QAAQ,CACZf,OAAO,CAACgB,UAAU,CAChB;QACE,GAAGJ,UAAU;QACbJ,IAAI,EAAG,IAAGE,MAAO;MACnB,CAAC,EACDN,MAAM,CAACa,MAAM,EACbb,MAAM,CACP,CACF;IACH;EACF;AACF,CAAC,CAAC;AAEFP,OAAO,CAACM,EAAE,CAAE,aAAY,EAAEC,MAAM,IAAI;EAClC,MAAMQ,UAAU,GAAGV,wBAAwB,CAACE,MAAM,CAACG,OAAO,CAACC,IAAI,CAAC;EAChE,IAAII,UAAU,EAAE;IACdd,KAAK,CAACiB,QAAQ,CACZf,OAAO,CAACkB,UAAU,CAAC;MACjB,GAAGN,UAAU;MACbJ,IAAI,EAAG,IAAGI,UAAU,CAACF,MAAO;IAC9B,CAAC,CAAC,CACH;IACDR,wBAAwB,CAACE,MAAM,CAACG,OAAO,CAACC,IAAI,CAAC,GAAG,IAAI;IACpDP,0BAA0B,CAACW,UAAU,CAACF,MAAM,CAAC,GAAG,IAAI;EACtD;AACF,CAAC,CAAC"}