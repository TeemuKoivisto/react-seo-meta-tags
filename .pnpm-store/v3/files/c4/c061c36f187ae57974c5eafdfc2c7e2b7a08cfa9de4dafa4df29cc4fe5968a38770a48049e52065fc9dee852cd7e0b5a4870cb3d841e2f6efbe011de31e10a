{"version":3,"file":"api-runner-error-parser.js","names":["errorParser","err","handlers","regex","cb","match","id","context","sourceMessage","arg","structured","errorMessage","Array","isArray","Error","message","matched","error","undefined"],"sources":["../../src/utils/api-runner-error-parser.ts"],"sourcesContent":["import { IMatch } from \"../types\"\n\nconst errorParser = ({ err }: { err: unknown }): IMatch => {\n  const handlers = [\n    {\n      regex: /(.+) is not defined/m,\n      cb: (match: RegExpMatchArray): IMatch => {\n        return {\n          id: `11330`,\n          context: { sourceMessage: match[0], arg: match[1] },\n        }\n      },\n    },\n  ]\n\n  let structured: IMatch | undefined\n  let errorMessage: string | undefined\n\n  // try to handle as many type of err as possible.\n  // the err might come from a plugin so we don't\n  // know what we are getting\n  if (Array.isArray(err)) {\n    err = err[0]\n  }\n  if (err instanceof Error) {\n    errorMessage = err.message\n  }\n  if (typeof err === `string`) {\n    errorMessage = err\n  }\n\n  for (const { regex, cb } of handlers) {\n    const matched = errorMessage?.match(regex)\n    if (matched) {\n      structured = {\n        ...cb(matched),\n      }\n      break\n    }\n  }\n\n  // if we haven't found any known error\n  if (!structured) {\n    return {\n      id: `11321`,\n      context: { sourceMessage: errorMessage || `` },\n      error: err instanceof Error ? err : undefined,\n    }\n  }\n\n  return structured\n}\n\nexport default errorParser\n"],"mappings":";;;;AAEA,MAAMA,WAAW,GAAG,CAAC;EAAEC;AAAsB,CAAC,KAAa;EACzD,MAAMC,QAAQ,GAAG,CACf;IACEC,KAAK,EAAE,sBAAsB;IAC7BC,EAAE,EAAGC,KAAuB,IAAa;MACvC,OAAO;QACLC,EAAE,EAAG,OAAM;QACXC,OAAO,EAAE;UAAEC,aAAa,EAAEH,KAAK,CAAC,CAAC,CAAC;UAAEI,GAAG,EAAEJ,KAAK,CAAC,CAAC;QAAE;MACpD,CAAC;IACH;EACF,CAAC,CACF;EAED,IAAIK,UAA8B;EAClC,IAAIC,YAAgC;;EAEpC;EACA;EACA;EACA,IAAIC,KAAK,CAACC,OAAO,CAACZ,GAAG,CAAC,EAAE;IACtBA,GAAG,GAAGA,GAAG,CAAC,CAAC,CAAC;EACd;EACA,IAAIA,GAAG,YAAYa,KAAK,EAAE;IACxBH,YAAY,GAAGV,GAAG,CAACc,OAAO;EAC5B;EACA,IAAI,OAAOd,GAAG,KAAM,QAAO,EAAE;IAC3BU,YAAY,GAAGV,GAAG;EACpB;EAEA,KAAK,MAAM;IAAEE,KAAK;IAAEC;EAAG,CAAC,IAAIF,QAAQ,EAAE;IAAA;IACpC,MAAMc,OAAO,oBAAGL,YAAY,kDAAZ,cAAcN,KAAK,CAACF,KAAK,CAAC;IAC1C,IAAIa,OAAO,EAAE;MACXN,UAAU,GAAG;QACX,GAAGN,EAAE,CAACY,OAAO;MACf,CAAC;MACD;IACF;EACF;;EAEA;EACA,IAAI,CAACN,UAAU,EAAE;IACf,OAAO;MACLJ,EAAE,EAAG,OAAM;MACXC,OAAO,EAAE;QAAEC,aAAa,EAAEG,YAAY,IAAK;MAAE,CAAC;MAC9CM,KAAK,EAAEhB,GAAG,YAAYa,KAAK,GAAGb,GAAG,GAAGiB;IACtC,CAAC;EACH;EAEA,OAAOR,UAAU;AACnB,CAAC;AAAA,eAEcV,WAAW;AAAA"}