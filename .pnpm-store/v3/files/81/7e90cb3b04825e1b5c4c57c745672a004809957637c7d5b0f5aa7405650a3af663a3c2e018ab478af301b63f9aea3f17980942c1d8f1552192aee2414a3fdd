{"version":3,"file":"browserslist.js","names":["installedGatsbyVersion","directory","version","require","path","join","parseInt","split","e","undefined","getBrowsersList","fallbackV1","fallbackOthers","map","fallback","config","browserslist","loadConfig","hasES6ModuleSupport","query","length"],"sources":["../../src/utils/browserslist.ts"],"sourcesContent":["import path from \"path\"\nimport browserslist from \"browserslist/node\"\nimport query from \"browserslist\"\n\nconst installedGatsbyVersion = (directory: string): number | undefined => {\n  try {\n    // eslint-disable-next-line @typescript-eslint/no-var-requires\n    const { version } = require(path.join(\n      directory,\n      `node_modules`,\n      `gatsby`,\n      `package.json`\n    ))\n    return parseInt(version.split(`.`)[0], 10)\n  } catch (e) {\n    return undefined\n  }\n}\n\nexport const getBrowsersList = (directory: string): Array<string> => {\n  const fallbackV1 = [`>1%`, `last 2 versions`, `IE >= 9`]\n  let fallbackOthers = [`>0.25%`, `not dead`]\n\n  if (_CFLAGS_.GATSBY_MAJOR === `5`) {\n    fallbackOthers = fallbackOthers.map(\n      fallback => fallback + ` and supports es6-module`\n    )\n  }\n\n  const fallback =\n    installedGatsbyVersion(directory) === 1 ? fallbackV1 : fallbackOthers\n\n  const config = browserslist.loadConfig({\n    path: directory,\n  })\n\n  return config ?? fallback\n}\n\nexport const hasES6ModuleSupport = (directory: string): boolean => {\n  const browserslist = getBrowsersList(directory)\n  return query(browserslist + `, not supports es6-module`).length === 0\n}\n"],"mappings":";;;;;AAAA;AACA;AACA;AAEA,MAAMA,sBAAsB,GAAIC,SAAiB,IAAyB;EACxE,IAAI;IACF;IACA,MAAM;MAAEC;IAAQ,CAAC,GAAGC,OAAO,CAACC,aAAI,CAACC,IAAI,CACnCJ,SAAS,EACR,cAAa,EACb,QAAO,EACP,cAAa,CACf,CAAC;IACF,OAAOK,QAAQ,CAACJ,OAAO,CAACK,KAAK,CAAE,GAAE,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;EAC5C,CAAC,CAAC,OAAOC,CAAC,EAAE;IACV,OAAOC,SAAS;EAClB;AACF,CAAC;AAEM,MAAMC,eAAe,GAAIT,SAAiB,IAAoB;EACnE,MAAMU,UAAU,GAAG,CAAE,KAAI,EAAG,iBAAgB,EAAG,SAAQ,CAAC;EACxD,IAAIC,cAAc,GAAG,CAAE,QAAO,EAAG,UAAS,CAAC;EAE3C,IAAI,QAA2B,GAAE,EAAE;IACjCA,cAAc,GAAGA,cAAc,CAACC,GAAG,CACjCC,QAAQ,IAAIA,QAAQ,GAAI,0BAAyB,CAClD;EACH;EAEA,MAAMA,QAAQ,GACZd,sBAAsB,CAACC,SAAS,CAAC,KAAK,CAAC,GAAGU,UAAU,GAAGC,cAAc;EAEvE,MAAMG,MAAM,GAAGC,aAAY,CAACC,UAAU,CAAC;IACrCb,IAAI,EAAEH;EACR,CAAC,CAAC;EAEF,OAAOc,MAAM,aAANA,MAAM,cAANA,MAAM,GAAID,QAAQ;AAC3B,CAAC;AAAA;AAEM,MAAMI,mBAAmB,GAAIjB,SAAiB,IAAc;EACjE,MAAMe,YAAY,GAAGN,eAAe,CAACT,SAAS,CAAC;EAC/C,OAAO,IAAAkB,qBAAK,EAACH,YAAY,GAAI,2BAA0B,CAAC,CAACI,MAAM,KAAK,CAAC;AACvE,CAAC;AAAA"}