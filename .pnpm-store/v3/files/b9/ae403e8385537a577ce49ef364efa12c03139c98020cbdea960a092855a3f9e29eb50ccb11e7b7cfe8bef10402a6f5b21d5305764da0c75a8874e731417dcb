{"version":3,"file":"ssr-develop-static-entry.js","names":["preferDefault","m","default","testRequireError","moduleName","err","regex","RegExp","firstLine","toString","split","test","cachedStats","getStats","publicDir","JSON","parse","fs","readFileSync","nodePath","join","Html","require","console","log","process","exit","__esModule","staticPage","pagePath","isClientOnlyPage","error","serverData","bodyHtml","headComponents","htmlAttributes","bodyAttributes","preBodyComponents","postBodyComponents","bodyProps","push","__html","stringify","sourceMessage","source","line","column","stack","generateBodyHTML","setHeadComponents","components","concat","setHtmlAttributes","attributes","setBodyAttributes","setPreBodyComponents","setPostBodyComponents","setBodyProps","props","getHeadComponents","replaceHeadComponents","replaceBodyHTMLString","body","getPreBodyComponents","replacePreBodyComponents","getPostBodyComponents","replacePostBodyComponents","getPageDataPath","path","fixedPagePath","getPageData","pageDataPath","absolutePageDataPath","pageDataJson","pageData","componentChunkName","slicesMap","pageComponent","syncRequires","ssrComponents","scriptsAndStyles","map","chunkKey","fetchKey","stats","chunks","namedChunkGroups","chunk","rel","name","assets","forEach","asset","childAssets","hasownProperty","filter","s","sort","s1","_s2","item","styles","style","endsWith","slice","reverse","unshift","__PATH_PREFIX__","RouteHandler","React","Component","render","result","params","grabMatchParams","location","pathname","pageContext","__params","pageElement","createElement","wrappedPage","apiRunner","element","pop","routerElement","__BASE_PATH__","RouteAnnouncerProps","bodyComponent","env","GATSBY_SLICES","readSliceData","sliceName","filePath","rawSliceData","slicesContext","renderEnvironment","sliceProps","slicesDb","Map","sliceData","Object","values","SliceComponent","getPageChunk","sliceObject","component","sliceContext","data","set","apiRunnerAsync","pathPrefix","writableStream","WritableAsPromise","pipe","renderToPipeableStream","onAllReady","onError","destroy","e","isRedirect","headHandlerForSSR","staticQueryContext","getStaticQueryResults","bodyStr","htmlElement","BROWSER_ESM_ONLY","Boolean","htmlStr","renderToStaticMarkup"],"sources":["../ssr-develop-static-entry.js"],"sourcesContent":["/* global BROWSER_ESM_ONLY */\nimport React from \"react\"\nimport fs from \"fs-extra\"\nimport { renderToStaticMarkup, renderToPipeableStream } from \"react-dom/server\"\nimport { get, merge, isObject, flatten, uniqBy, concat } from \"lodash\"\nimport nodePath from \"path\"\nimport { apiRunner, apiRunnerAsync } from \"./api-runner-ssr\"\nimport { grabMatchParams } from \"./find-path\"\nimport syncRequires from \"$virtual/ssr-sync-requires\"\n\nimport { RouteAnnouncerProps } from \"./route-announcer-props\"\nimport { ServerLocation, Router, isRedirect } from \"@gatsbyjs/reach-router\"\nimport { headHandlerForSSR } from \"./head/head-export-handler-for-ssr\"\nimport { getStaticQueryResults } from \"./loader\"\nimport { WritableAsPromise } from \"./server-utils/writable-as-promise\"\nimport {\n  SlicesResultsContext,\n  SlicesContext,\n  SlicesMapContext,\n  SlicesPropsContext,\n} from \"./slice/context\"\n\n// prefer default export if available\nconst preferDefault = m => (m && m.default) || m\n\nconst testRequireError = (moduleName, err) => {\n  const regex = new RegExp(`Error: Cannot find module\\\\s.${moduleName}`)\n  const firstLine = err.toString().split(`\\n`)[0]\n  return regex.test(firstLine)\n}\n\nlet cachedStats\nconst getStats = publicDir => {\n  if (cachedStats) {\n    return cachedStats\n  } else {\n    cachedStats = JSON.parse(\n      fs.readFileSync(nodePath.join(publicDir, `webpack.stats.json`), `utf-8`)\n    )\n\n    return cachedStats\n  }\n}\n\nlet Html\ntry {\n  Html = require(`../src/html`)\n} catch (err) {\n  if (testRequireError(`../src/html`, err)) {\n    Html = require(`./default-html`)\n  } else {\n    console.log(`There was an error requiring \"src/html.js\"\\n\\n`, err, `\\n\\n`)\n    process.exit()\n  }\n}\n\nHtml = Html && Html.__esModule ? Html.default : Html\n\nexport default async function staticPage({\n  pagePath,\n  isClientOnlyPage,\n  publicDir,\n  error,\n  serverData,\n}) {\n  let bodyHtml = ``\n  let headComponents = [\n    <meta key=\"environment\" name=\"note\" content=\"environment=development\" />,\n  ]\n  let htmlAttributes = {}\n  let bodyAttributes = {}\n  let preBodyComponents = []\n  let postBodyComponents = []\n  let bodyProps = {}\n\n  if (error) {\n    postBodyComponents.push([\n      <script\n        key=\"dev-ssr-error\"\n        dangerouslySetInnerHTML={{\n          __html: `window._gatsbyEvents = window._gatsbyEvents || []; window._gatsbyEvents.push([\"FAST_REFRESH\", { action: \"SHOW_DEV_SSR_ERROR\", payload: ${JSON.stringify(\n            error\n          )} }])`,\n        }}\n      />,\n      <noscript key=\"dev-ssr-error-noscript\">\n        <h1>Failed to Server Render (SSR)</h1>\n        <h2>Error message:</h2>\n        <p>{error.sourceMessage}</p>\n        <h2>File:</h2>\n        <p>\n          {error.source}:{error.line}:{error.column}\n        </p>\n        <h2>Stack:</h2>\n        <pre>\n          <code>{error.stack}</code>\n        </pre>\n      </noscript>,\n    ])\n  }\n\n  const generateBodyHTML = async () => {\n    const setHeadComponents = components => {\n      headComponents = headComponents.concat(components)\n    }\n\n    const setHtmlAttributes = attributes => {\n      htmlAttributes = merge(htmlAttributes, attributes)\n    }\n\n    const setBodyAttributes = attributes => {\n      bodyAttributes = merge(bodyAttributes, attributes)\n    }\n\n    const setPreBodyComponents = components => {\n      preBodyComponents = preBodyComponents.concat(components)\n    }\n\n    const setPostBodyComponents = components => {\n      postBodyComponents = postBodyComponents.concat(components)\n    }\n\n    const setBodyProps = props => {\n      bodyProps = merge({}, bodyProps, props)\n    }\n\n    const getHeadComponents = () => headComponents\n\n    const replaceHeadComponents = components => {\n      headComponents = components\n    }\n\n    const replaceBodyHTMLString = body => {\n      bodyHtml = body\n    }\n\n    const getPreBodyComponents = () => preBodyComponents\n\n    const replacePreBodyComponents = components => {\n      preBodyComponents = components\n    }\n\n    const getPostBodyComponents = () => postBodyComponents\n\n    const replacePostBodyComponents = components => {\n      postBodyComponents = components\n    }\n\n    const getPageDataPath = path => {\n      const fixedPagePath = path === `/` ? `index` : path\n      return nodePath.join(`page-data`, fixedPagePath, `page-data.json`)\n    }\n\n    const getPageData = pagePath => {\n      const pageDataPath = getPageDataPath(pagePath)\n      const absolutePageDataPath = nodePath.join(publicDir, pageDataPath)\n      const pageDataJson = fs.readFileSync(absolutePageDataPath, `utf8`)\n\n      try {\n        return JSON.parse(pageDataJson)\n      } catch (err) {\n        return null\n      }\n    }\n\n    const pageData = getPageData(pagePath)\n\n    const { componentChunkName, slicesMap } = pageData\n\n    const pageComponent = await syncRequires.ssrComponents[componentChunkName]\n\n    let scriptsAndStyles = flatten(\n      [`commons`].map(chunkKey => {\n        const fetchKey = `assetsByChunkName[${chunkKey}]`\n\n        const stats = getStats(publicDir)\n        let chunks = get(stats, fetchKey)\n        const namedChunkGroups = get(stats, `namedChunkGroups`)\n\n        if (!chunks) {\n          return null\n        }\n\n        chunks = chunks.map(chunk => {\n          if (chunk === `/`) {\n            return null\n          }\n          return { rel: `preload`, name: chunk }\n        })\n\n        namedChunkGroups[chunkKey].assets.forEach(asset =>\n          chunks.push({ rel: `preload`, name: asset.name })\n        )\n\n        const childAssets = namedChunkGroups[chunkKey].childAssets\n        for (const rel in childAssets) {\n          if (childAssets.hasownProperty(rel)) {\n            chunks = concat(\n              chunks,\n              childAssets[rel].map(chunk => {\n                return { rel, name: chunk }\n              })\n            )\n          }\n        }\n\n        return chunks\n      })\n    )\n      .filter(s => isObject(s))\n      .sort((s1, _s2) => (s1.rel == `preload` ? -1 : 1)) // given priority to preload\n\n    scriptsAndStyles = uniqBy(scriptsAndStyles, item => item.name)\n\n    const styles = scriptsAndStyles.filter(\n      style => style.name && style.name.endsWith(`.css`)\n    )\n\n    styles\n      .slice(0)\n      .reverse()\n      .forEach(style => {\n        headComponents.unshift(\n          <link\n            data-identity={`gatsby-dev-css`}\n            key={style.name}\n            rel=\"stylesheet\"\n            type=\"text/css\"\n            href={`${__PATH_PREFIX__}/${style.name}`}\n          />\n        )\n      })\n    class RouteHandler extends React.Component {\n      render() {\n        const props = {\n          ...this.props,\n          ...pageData.result,\n          serverData,\n          params: {\n            ...grabMatchParams(this.props.location.pathname),\n            ...(pageData.result?.pageContext?.__params || {}),\n          },\n        }\n\n        const pageElement = React.createElement(\n          preferDefault(syncRequires.ssrComponents[componentChunkName]),\n          props\n        )\n\n        const wrappedPage = apiRunner(\n          `wrapPageElement`,\n          { element: pageElement, props },\n          pageElement,\n          ({ result }) => {\n            return { element: result, props }\n          }\n        ).pop()\n\n        return wrappedPage\n      }\n    }\n\n    const routerElement =\n      syncRequires.ssrComponents[componentChunkName] && !isClientOnlyPage ? (\n        <ServerLocation url={`${__BASE_PATH__}${pagePath}`}>\n          <Router id=\"gatsby-focus-wrapper\" baseuri={__BASE_PATH__}>\n            <RouteHandler path=\"/*\" />\n          </Router>\n          <div {...RouteAnnouncerProps} />\n        </ServerLocation>\n      ) : null\n\n    let bodyComponent = apiRunner(\n      `wrapRootElement`,\n      { element: routerElement, pathname: pagePath },\n      routerElement,\n      ({ result }) => {\n        return { element: result, pathname: pagePath }\n      }\n    ).pop()\n\n    if (process.env.GATSBY_SLICES) {\n      const readSliceData = sliceName => {\n        const filePath = nodePath.join(\n          publicDir,\n          `slice-data`,\n          `${sliceName}.json`\n        )\n\n        const rawSliceData = fs.readFileSync(filePath, `utf-8`)\n        return JSON.parse(rawSliceData)\n      }\n\n      const slicesContext = {\n        renderEnvironment: `dev-ssr`,\n      }\n      const sliceProps = {}\n      const slicesDb = new Map()\n      const sliceData = {}\n      for (const sliceName of Object.values(slicesMap)) {\n        sliceData[sliceName] = await readSliceData(sliceName)\n      }\n\n      for (const sliceName of Object.values(slicesMap)) {\n        const slice = sliceData[sliceName]\n        const { default: SliceComponent } = await getPageChunk(slice)\n\n        const sliceObject = {\n          component: SliceComponent,\n          sliceContext: slice.result.sliceContext,\n          data: slice.result.data,\n        }\n\n        slicesDb.set(sliceName, sliceObject)\n      }\n\n      bodyComponent = (\n        <SlicesContext.Provider value={slicesContext}>\n          <SlicesPropsContext.Provider value={sliceProps}>\n            <SlicesMapContext.Provider value={slicesMap}>\n              <SlicesResultsContext.Provider value={slicesDb}>\n                {bodyComponent}\n              </SlicesResultsContext.Provider>\n            </SlicesMapContext.Provider>\n          </SlicesPropsContext.Provider>\n        </SlicesContext.Provider>\n      )\n    }\n\n    // Let the site or plugin render the page component.\n    await apiRunnerAsync(`replaceRenderer`, {\n      bodyComponent,\n      replaceBodyHTMLString,\n      setHeadComponents,\n      setHtmlAttributes,\n      setBodyAttributes,\n      setPreBodyComponents,\n      setPostBodyComponents,\n      setBodyProps,\n      pathname: pagePath,\n      pathPrefix: __PATH_PREFIX__,\n    })\n\n    // If no one stepped up, we'll handle it.\n    if (!bodyHtml) {\n      try {\n        const writableStream = new WritableAsPromise()\n        const { pipe } = renderToPipeableStream(bodyComponent, {\n          onAllReady() {\n            pipe(writableStream)\n          },\n          onError(error) {\n            writableStream.destroy(error)\n          },\n        })\n\n        bodyHtml = await writableStream\n      } catch (e) {\n        // ignore @reach/router redirect errors\n        if (!isRedirect(e)) throw e\n      }\n    }\n\n    apiRunner(`onRenderBody`, {\n      setHeadComponents,\n      setHtmlAttributes,\n      setBodyAttributes,\n      setPreBodyComponents,\n      setPostBodyComponents,\n      setBodyProps,\n      pathname: pagePath,\n    })\n\n    // we want to run Head after onRenderBody, so Html and Body attributes\n    // from Head wins over global ones from onRenderBody\n    headHandlerForSSR({\n      pageComponent,\n      setHeadComponents,\n      setHtmlAttributes,\n      setBodyAttributes,\n      staticQueryContext: getStaticQueryResults(),\n      pageData,\n      pagePath,\n    })\n\n    apiRunner(`onPreRenderHTML`, {\n      getHeadComponents,\n      replaceHeadComponents,\n      getPreBodyComponents,\n      replacePreBodyComponents,\n      getPostBodyComponents,\n      replacePostBodyComponents,\n      pathname: pagePath,\n    })\n\n    return bodyHtml\n  }\n\n  const bodyStr = await generateBodyHTML()\n\n  const htmlElement = React.createElement(Html, {\n    ...bodyProps,\n    body: bodyStr,\n    headComponents: headComponents.concat([\n      <script key={`io`} src=\"/socket.io/socket.io.js\" />,\n    ]),\n    htmlAttributes,\n    bodyAttributes,\n    preBodyComponents,\n    postBodyComponents: postBodyComponents.concat(\n      [\n        !BROWSER_ESM_ONLY && (\n          <script key={`polyfill`} src=\"/polyfill.js\" noModule={true} />\n        ),\n        <script key={`framework`} src=\"/framework.js\" />,\n        <script key={`commons`} src=\"/commons.js\" />,\n      ].filter(Boolean)\n    ),\n  })\n  let htmlStr = renderToStaticMarkup(htmlElement)\n  htmlStr = `<!DOCTYPE html>${htmlStr}`\n\n  return htmlStr\n}\n\nexport function getPageChunk({ componentChunkName }) {\n  return syncRequires.ssrComponents[componentChunkName]\n}\n"],"mappings":"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"}