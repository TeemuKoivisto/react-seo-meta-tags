{"version":3,"file":"nodes.js","names":["updateNodes","nodesDb","action","type","put","payload","id","remove","path","node","get","Error","mode","pageMode"],"sources":["../../../../src/datastore/lmdb/updates/nodes.ts"],"sourcesContent":["import { ActionsUnion, IGatsbyNode } from \"../../../redux/types\"\nimport type { Database } from \"lmdb\"\n\ntype NodeId = string\n\nexport function updateNodes(\n  nodesDb: Database<IGatsbyNode, NodeId>,\n  action: ActionsUnion\n): Promise<boolean> | boolean {\n  switch (action.type) {\n    case `CREATE_NODE`:\n    case `ADD_FIELD_TO_NODE`:\n    case `ADD_CHILD_NODE_TO_PARENT_NODE`: {\n      return nodesDb.put(action.payload.id, action.payload)\n    }\n    case `DELETE_NODE`: {\n      if (action.payload) {\n        return nodesDb.remove(action.payload.id)\n      }\n\n      return false\n    }\n    case `MATERIALIZE_PAGE_MODE`: {\n      const id = `SitePage ${action.payload.path}`\n      const node = nodesDb.get(id)\n      if (!node) {\n        throw new Error(`Could not find SitePage node by id: ${id}`)\n      }\n      node.mode = action.payload.pageMode\n      return nodesDb.put(id, node)\n    }\n  }\n  return false\n}\n"],"mappings":";;;;AAKO,SAASA,WAAW,CACzBC,OAAsC,EACtCC,MAAoB,EACQ;EAC5B,QAAQA,MAAM,CAACC,IAAI;IACjB,KAAM,aAAY;IAClB,KAAM,mBAAkB;IACxB,KAAM,+BAA8B;MAAE;QACpC,OAAOF,OAAO,CAACG,GAAG,CAACF,MAAM,CAACG,OAAO,CAACC,EAAE,EAAEJ,MAAM,CAACG,OAAO,CAAC;MACvD;IACA,KAAM,aAAY;MAAE;QAClB,IAAIH,MAAM,CAACG,OAAO,EAAE;UAClB,OAAOJ,OAAO,CAACM,MAAM,CAACL,MAAM,CAACG,OAAO,CAACC,EAAE,CAAC;QAC1C;QAEA,OAAO,KAAK;MACd;IACA,KAAM,uBAAsB;MAAE;QAC5B,MAAMA,EAAE,GAAI,YAAWJ,MAAM,CAACG,OAAO,CAACG,IAAK,EAAC;QAC5C,MAAMC,IAAI,GAAGR,OAAO,CAACS,GAAG,CAACJ,EAAE,CAAC;QAC5B,IAAI,CAACG,IAAI,EAAE;UACT,MAAM,IAAIE,KAAK,CAAE,uCAAsCL,EAAG,EAAC,CAAC;QAC9D;QACAG,IAAI,CAACG,IAAI,GAAGV,MAAM,CAACG,OAAO,CAACQ,QAAQ;QACnC,OAAOZ,OAAO,CAACG,GAAG,CAACE,EAAE,EAAEG,IAAI,CAAC;MAC9B;EAAC;EAEH,OAAO,KAAK;AACd"}